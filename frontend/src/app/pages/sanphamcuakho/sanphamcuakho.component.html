
<body style="background-color: beige;">

  <!-- B·ªò L·ªåC N√ÇNG CAO -->
<div class="container py-4">
  <div class="filter-bar shadow-sm p-3 rounded bg-white mb-4">
    <div class="d-flex flex-wrap gap-3">
      <!-- C√°c nh√≥m b·ªô l·ªçc -->
      <!-- Khu v·ª±c -->
    <div class="filter-group">
    <label>Khu v·ª±c</label>
    <select class="form-select" [(ngModel)]="selectedKhuVuc" (change)="onKhuVucChange()">
        <option value="">T·∫•t c·∫£ khu</option>
        <option *ngFor="let kv of danhSachKhuVuc" [value]="kv.id">{{ kv.ten_khu_vuc }}</option>
    </select>
    </div>

    <!-- Lo·∫°i h√†ng -->
    <div class="filter-group">
    <label>Lo·∫°i h√†ng</label>
    <select class="form-select" [(ngModel)]="selectedType">
        <option value="">T·∫•t c·∫£ lo·∫°i</option>
        <option *ngFor="let type of loaiHang" [value]="type">{{ type }}</option>
    </select>
    </div>


      <div class="filter-group">
        <label>T√¨m ki·∫øm</label>
        <input type="text" class="form-control" [(ngModel)]="keyword" placeholder="üîç M√£ ho·∫∑c t√™n s·∫£n ph·∫©m" />
      </div>

      <div class="filter-group">
        <label>‚è≥ H·∫°n s·ª≠ d·ª•ng</label>
        <input type="date" class="form-control" [(ngModel)]="toDate" />
      </div>

      <div class="filter-group">
        <label>üí∞ Gi√° t·ª´</label>
        <input type="number" class="form-control" [(ngModel)]="minPrice" placeholder="Min" />
      </div>

      <div class="filter-group">
        <label>üí∞ ƒë·∫øn</label>
        <input type="number" class="form-control" [(ngModel)]="maxPrice" placeholder="Max" />
      </div>
    </div>

    <!-- N√∫t l·ªçc s√°t ph·∫£i -->
    <div class="d-flex justify-content-end mt-3">
      <button class="btn btn-primary fw-bold px-4" (click)="layDanhSachSanPham()">üîç L·ªçc s·∫£n ph·∫©m</button>
    </div>
  </div>
</div>


<!-- DANH S√ÅCH S·∫¢N PH·∫®M -->
<div class="container mt-4">
  <div class="row">
    <div class="col-lg-3 col-md-4 col-sm-6 mb-4" *ngFor="let sp of sanPhamList" (click)="chonSanPham(sp)">
      <div class="product-card shadow">
        <div class="product-image">
          <img [src]="sp.image_url || '/assets/images/no-image.jpg'" class="img-fluid" alt="{{ sp.product_name }}">
          <img *ngIf="sp.logo_url" class="supplier-logo" [src]="sp.logo_url" alt="Logo">
        </div>
        <!-- M√£ v·∫°ch -->
          <div class="barcode mt-2">
          <img [src]="'https://barcode.tec-it.com/barcode.ashx?data=' + sp.product_code" class="barcode-img" alt="Barcode">
          </div>
        <div class="product-info">
          <h5>{{ sp.product_name }}</h5>
          <p><strong>Lo·∫°i:</strong> {{ sp.product_type }}</p>
          <p><strong>Khu:</strong> {{ sp.ten_khu_vuc || 'Ch∆∞a ph√¢n' }}</p>
          <p><strong>Gi√°:</strong> {{ sp.unit_price | number:'1.0-0' }} ƒë</p>
          <p><strong>SL:</strong> {{ sp.quantity }} {{ sp.unit }}</p>
        </div>

        <!-- ‚úÖ N√∫t th√™m v√†o ƒë∆°n h√†ng b√™n d∆∞·ªõi -->
        <div class="text-center mb-3">
          <button class="btn-them-vao-don" (click)="themVaoPhieuMua(sp); $event.stopPropagation()">
            ‚ûï Th√™m v√†o phi·∫øu xu·∫•t
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- POPUP CHI TI·∫æT -->
<div class="product-modal" *ngIf="selectedProduct">
  <div class="modal-content">
    <button class="close-btn" (click)="selectedProduct = null">‚úñ</button>
    <div class="d-flex">
      <div>
        <img [src]="selectedProduct.image_url || '/assets/images/no-image.jpg'" class="popup-img me-3">
        <!-- ‚úÖ M√£ s·∫£n ph·∫©m n·∫±m d∆∞·ªõi h√¨nh -->
        <div class="text-center mt-2">
          <p><strong>M√£ SP:</strong> {{ selectedProduct.product_code }}</p>
          <img [src]="'https://barcode.tec-it.com/barcode.ashx?data=' + selectedProduct.product_code" class="barcode-img" alt="Barcode">
        </div>
      </div>

      <!-- Th√¥ng tin s·∫£n ph·∫©m -->
      <div class="popup-details">
        <h3>{{ selectedProduct.product_name }}</h3>
        <p><strong>Lo·∫°i:</strong> {{ selectedProduct.product_type }}</p>
        <p><strong>ƒê∆°n v·ªã:</strong> {{ selectedProduct.unit }}</p>
         <p><strong>Tr·ªçng l∆∞·ª£ng 1 ƒë∆°n v·ªã:</strong> {{ selectedProduct.weight_per_unit }} kg</p>
        <p><strong>Ng√†y s·∫£n xu·∫•t:</strong> {{ selectedProduct.manufacture_date | date:'dd/MM/yyyy' }}</p>
        <p><strong>H·∫°n s·ª≠ d·ª•ng:</strong> {{ selectedProduct.expiry_date | date:'dd/MM/yyyy' }}</p>
        <p><strong>Khu v·ª±c:</strong> {{ selectedProduct.ten_khu_vuc }}</p>
        <p><strong>S·ªë l∆∞·ª£ng trong kho:</strong> {{ selectedProduct.quantity }}</p>
        <p><strong>Gi√°:</strong> {{ selectedProduct.unit_price | number:'1.0-0' }} ƒë</p>
        <button class="btn btn-success mt-2" (click)="themVaoPhieuMua(selectedProduct)">‚ûï Th√™m v√†o phi·∫øu xu·∫•t</button>
      </div>
    </div>
  </div>
</div>


</body>