
<body style="background-color: beige;">

  <div class="main-banner wow fadeIn" id="top" data-wow-duration="1s" data-wow-delay="0.5s">
    <div class="container">
      <div class="row">
        <div class="col-lg-12">
            <div class="form-container">
            <h2>üì¶ PHI·∫æU NH·∫¨P KHO - WAREHOUSE MANAGER T&H</h2>
            
            <form (ngSubmit)="submitForm()" enctype="multipart/form-data">
              <!-- Ng√†y t·∫°o -->
              <div class="row">
                <label>üìÖ Ng√†y t·∫°o:</label>
                <input type="date" [(ngModel)]="formData.created_date" name="created_date" readonly>

                <label style="margin-left: 20px;">üìÑ M√£ phi·∫øu:</label>
                <input type="text" [value]="generatedReceiptCode || 'ƒêang t·∫°o...'" readonly>
              </div>

              <!-- T√™n nh√† cung c·∫•p -->
              <div class="row">
                <label>üè¢ T√™n nh√† cung c·∫•p:</label>
                <input type="text" [(ngModel)]="formData.supplier_name" name="supplier_name" required>
              </div>

              <!-- Logo nh√† cung c·∫•p -->
              <div class="row">
                <label>üñºÔ∏è Logo nh√† cung c·∫•p:</label>
                <input type="file" accept="image/*" (change)="onLogoChange($event)">
                <img *ngIf="formData.logoPreview" [src]="formData.logoPreview" class="preview-img">
              </div>

              <!-- ƒê·ªãa ch·ªâ nh√† cung c·∫•p -->
              <div class="row">
                <label>üìç ƒê·ªãa ch·ªâ nh√† cung c·∫•p:</label>
                <input type="text" [(ngModel)]="formData.supplier_address" name="supplier_address" required>
              </div>

              <!-- Th√¥ng tin ƒë·∫°i di·ªán nh√† cung c·∫•p -->
              <div class="info-card">
                <h4>üßæ Th√¥ng tin li√™n l·∫°c nh√† cung c·∫•p</h4>
                <div class="row">
                  <label>üë§ H·ªç v√† t√™n ƒë·∫°i di·ªán:</label>
                  <input type="text" [(ngModel)]="formData.representative_name" name="representative_name" required>
                </div>

                <div class="row">
                  <label>üìß Email ƒë·∫°i di·ªán:</label>
                  <input type="email" [(ngModel)]="formData.representative_email" name="representative_email" required>
                </div>

                <div class="row">
                  <label>üìû S·ªë ƒëi·ªán tho·∫°i:</label>
                  <input type="text" [(ngModel)]="formData.representative_phone" name="representative_phone" required>
                </div>
              </div>

              <!-- üîî Ghi ch√∫ y√™u c·∫ßu c·∫≠p nh·∫≠t ƒë·∫ßy ƒë·ªß th√¥ng tin -->
              <div class="alert alert-warning" style="margin-bottom: 15px; background-color: #fff3cd; padding: 10px; border-left: 5px solid #ffc107;">
                 <strong>L∆∞u √Ω:</strong> Phi·∫øu ch·ªâ ƒë∆∞·ª£c g·ª≠i khi b·∫°n c·∫≠p nh·∫≠t ƒë·∫ßy ƒë·ªß th√¥ng tin nh√¢n vi√™n.
              </div>

              <div class="info-card">
                <!-- T√™n nh√¢n vi√™n -->
                <div class="row">
                  <label>üë§ T√™n nh√¢n vi√™n t·∫°o phi·∫øu</label>
                  <input type="text" [value]="userInfo.full_name" readonly>
                </div>
                
                <!-- T√†i kho·∫£n nh√¢n vi√™n-->
                <div class="row">
                  <label>üë§ T√†i kho·∫£n nh√¢n vi√™n t·∫°o phi·∫øu</label>
                  <input type="text" [value]="userEmail" readonly>
                </div>
              </div>


              <h4>üìù Danh s√°ch s·∫£n ph·∫©m</h4>
              <div style="overflow-x: auto;" class="table-container">
                <table>
                  <thead>
                    <tr>
                      <th>STT</th>
                      <th>H√¨nh ·∫£nh</th>
                      <th>M√£ s·∫£n ph·∫©m</th>
                      <th>T√™n s·∫£n ph·∫©m</th>
                      <th>Lo·∫°i</th>
                      <th>ƒê∆°n v·ªã</th>
                      <th>Ng√†y s·∫£n xu·∫•t</th>
                      <th>H·∫°n s·ª≠ d·ª•ng</th>
                      
                      <th>S·ªë l∆∞·ª£ng</th>
                      <th>Tr·ªçng l∆∞·ª£ng 1 s·∫£n ph·∫©m (KG)</th> <!-- üÜï C·ªôt m·ªõi -->
                      <th>Tr·ªçng l∆∞·ª£ng l√¥ h√†ng (KG)</th>
                      <th>Di·ªán t√≠ch (m<sup>2</sup>)</th>

                      <th>ƒê∆°n gi√°</th>
                      <th>Th√†nh ti·ªÅn</th>
                      <th>Xo√°</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr *ngFor="let item of formData.products; let i = index">
                      <td>{{ i + 1 }}</td>
                      <td>
                        <input type="file" accept="image/*" (change)="onProductImageChange($event, i)">
                        <img *ngIf="item.preview" [src]="item.preview" class="preview-img-small">
                      </td>
                      <td>
                        <input [(ngModel)]="item.product_code" name="code{{i}}" required>
                        <div *ngIf="item.product_code">
                        </div>
                      </td>
                      <td><input [(ngModel)]="item.product_name" name="product_name{{i}}" required></td>
                      <td><input [(ngModel)]="item.product_type" name="type{{i}}" required></td>
                      <td><input [(ngModel)]="item.unit" name="unit{{i}}" required></td>
                      <td><input [(ngModel)]="item.manufacture_date" name="nsx{{i}}" type="date" required></td>
                      <td><input [(ngModel)]="item.expiry_date" name="hsd{{i}}" type="date" required></td>
                      
                      <td><input [(ngModel)]="item.quantity" name="quantity{{i}}" type="number" required></td>
                      <!-- Tr·ªçng l∆∞·ª£ng 1 s·∫£n ph·∫©m (KG) -->
                      <td>
                        <div style="display: flex; align-items: center;">
                          <input [(ngModel)]="item.kg_per_unit" name="kgperunit{{i}}" type="number" required
                                (input)="updateWeightAndArea(i)" style="width: 80px;">
                          <span style="margin-left: 4px;">kg</span>
                        </div>
                      </td>

                      <!-- Tr·ªçng l∆∞·ª£ng l√¥ h√†ng (KG) - readonly -->
                      <td>
                        <div style="display: flex; align-items: center;">
                          <input [(ngModel)]="item.weight" name="weight{{i}}" type="number" readonly style="width: 80px; background-color: #f9f9f9;">
                          <span style="margin-left: 4px;">kg</span>
                        </div>
                      </td>

                      <!-- Di·ªán t√≠ch (m¬≤) - readonly -->
                      <td>
                        <div style="display: flex; align-items: center;">
                          <input [(ngModel)]="item.area" name="area{{i}}" type="number" readonly style="width: 80px; background-color: #f9f9f9;">
                          <span style="margin-left: 4px;">m¬≤</span>
                        </div>
                      </td>

                      
                      <td><input [(ngModel)]="item.unit_price" name="price{{i}}" type="number" required></td>
                      <td>{{ item.quantity * item.unit_price | number:'1.0-0' }}</td>
                      <td><button type="button" (click)="removeProduct(i)">üóëÔ∏è</button></td>
                    </tr>
                  </tbody>
                </table>
              </div>


              <button type="button" (click)="addProduct()">‚ûï Th√™m s·∫£n ph·∫©m</button>

              <br>
              <br>

              <!-- T·ªïng c·ªông -->
              <div class="row total-row">
                <label>T·ªïng c·ªông: <span>{{ calculateTotal() | number:'1.0-0' }} VNƒê</span></label>
              </div>

              <!-- Ng√†y h·∫πn g·∫∑p m·∫∑t -->
              <div class="row">
                <label>üìÖ Ng√†y h·∫πn nh·∫≠p h√†ng:</label>
                <input type="date" [(ngModel)]="formData.appointment_date" name="appointment_date" required>
              </div>

              <!-- Ghi ch√∫ -->
              <div class="row">
                <label>üìù Ghi ch√∫ cho qu·∫£n l√Ω kho (n·∫øu c√≥):</label>
                <textarea rows="4" [(ngModel)]="formData.note" name="note" placeholder="Nh·∫≠p ghi ch√∫ n·∫øu c√≥..."></textarea>
              </div>


              <!-- G·ª≠i -->
              <button type="submit" class="submit-btn">‚úÖ G·ª≠i phi·∫øu nh·∫≠p h√†ng</button>
            </form>

          </div>
        </div>
      </div>
    </div>
  </div>

</body>